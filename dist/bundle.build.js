!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=o(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,a=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}("#closeX {\n\twidth: 25px;\n\theight: 25px;\n\tbackground: #000;\n}\n\n#envBox {\n  position: fixed;\n\tz-index: 9999999999999999;\n\ttop: 50%;\n\tright: 0;\n\twidth: 15px;\n\theight: 15px;\n\tbackground: rgb(190, 190, 190);\n\tborder: 1rpx solid #919191;\n\tborder-radius: 50% 0% 0% 50%;\n}\n#envBox-expand {\n\tposition: fixed;\n\tz-index: 9999999999999;\n\ttop: 50%;\n\tright: 0;\n\tbackground: transprant;\n}\n");var c=window.localStorage.getItem("global_env")||"dev",s=!1,l={insertDOM:document.querySelector("#app"),wait:1e3,needSleep:!1,envBoxIdName:"envBox",envBoxExpandIdName:"envBox-expand",envList:["test","dev","prebrand"],watchPerformance:!0,watchError:!0,watchRoutes:!0,watchActions:!0,watchActionDOMList:[{eventType:"click",domId:".test1"}],sendOptions:{commonInfo:{pid:"",mid:"",uid:"",did:""},method:"gif",baseURL:"http://localhost:8000"},maxLimit:5,asyncTime:5e3,endTime:1e4},d={errorCount:0,errorSum:"",errorList:[]},u={routeInfo:{url:"",referer:"",title:"",action:"",sendTime:"",triggerTime:""},routesList:[]},f=function(t){for(var e in console.log(t),t){if(null==t[e])throw new Error("options exist null or undefined----"+e)}},h=function(){window.addEventListener("error",(function(t){v("global error"+t.message)})),window.addEventListener("unhandledrejection",(function(t){v("promise error"+t.reason)}))},p=function(){l.watchActionDOMList.forEach((function(t){var e=t.domId&&document.querySelectorAll(t.domId);e&&e.forEach((function(e){e.addEventListener(t.eventType,(function(){x({type:t.eventType,DOM:t.domId},"action")}))}))}))},m=function(){u.routeInfo.url=window.location.href,u.routeInfo.title=document.title,console.log(u),window.addEventListener("popstate",(function(t){console.log("路由变化",t)}))},v=function(t){var e=d.errorList,n=l.asyncTime;if(t&&(e.push(t),d.errorCount+=1,"array"===T(e))){d.errorSum+="".concat(d.errorCount,": ")+t+"\n";var r={errorSum:d.errorSum};if(d.errorCount>=l.maxLimit)x(r,"err"),d.errorList=[];else{if(!d.errorList.length)return;setTimeout((function(){d.errorCount<l.maxLimit&&(x(r,"err"),d.errorList=[])}),n)}}},y=function(t){var e=t.envBoxIdName,n=t.envBoxExpandIdName,r=t.insertDOM,o=t.watchPerformance,i=t.watchError,a=t.watchRoutes,c=document.createElement("div");c.id=e,r.appendChild(c),c.addEventListener("click",(function(t){c.id=n,s=!0,w(c),o&&g(c),i&&b(c),a&&E(c)}),!1),document.addEventListener("click",(function(t){t.target.id!==c.id&&s&&(c.id=e,c.innerHTML="",s=!1)}),!1)},w=function(t){var e="<span>now: ".concat(c,"</span>");["test","dev","prebrand"].forEach((function(t){e+="<button>".concat(t,"</button>")})),t.innerHTML=e,document.querySelectorAll("#envBox, button").forEach((function(t){t.addEventListener("click",(function(e){var n=e.target.textContent;window.localStorage.setItem("global_env",n),t.innerText=n,window.localStorage.setItem("global_url","https://".concat(n,".zzss.com")),alert("已成功修改"+n+"环境")}),!1)}))},g=function(t){console.log(t);var e=document.createElement("button");t.appendChild(e);var n,r,o,i=window.performance.timing,a=i.domLoading,c=i.navigationStart,s=i.domContentLoadedEventEnd,l=i.loadEventEnd;n=a-c,r=s-c,o=l-c,e.innerText="performance",e.onclick=function(){alert("FP:".concat(n,"ms----DCL:").concat(r,"ms---L:").concat(o,"ms"))}},b=function(t){var e=d.errorSum,n=document.createElement("button");t.appendChild(n),n.innerText="error",n.onclick=function(){alert(e)}},E=function(t){var e=u.routeInfo,n=document.createElement("button");t.appendChild(n),n.innerText="route",n.onclick=function(){for(var t="",n=0,o=Object.entries(e);n<o.length;n++){var i=r(o[n],2);t+=i[0]+"-----"+i[1]+"\n"}alert(t)}},x=function(t,e,n){if("object"!==T(t)&&!e)throw new Error("do not input object or type");var o=l.sendOptions,i=o.baseURL,a=o.commonInfo,c=o.method,s=Object.assign({},t,a),d=Object.entries(s).map((function(t){var e=r(t,2),n=e[0],o=e[1];return"".concat(n,"=").concat(o)})).join("&");if("gif"===n||"gif"===c){var u=new Image;u.src="".concat(i,"?")+encodeURIComponent(d),console.log("上传信息",decodeURIComponent(u.src))}"beacon"!==n&&"beacon"!==c||navigator.sendBeacon(i,s)},T=function(t){return t&&Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},L={startdevTools:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;Object.assign(l,t),f(l),l.watchError&&h(),l.watchActions&&p(),l.watchRoutes&&m();var e=l.needSleep,n=l.wait;e?setTimeout((function(){y(l)}),n):y(l)},sendMsg:x},I=n((function e(n,r){t(this,e);var o=new Map;n.addEventListener("touchstart",(function(t){var e,n=a(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var i=e.value,c=Object.create(null);o.set(i.identifier,c),r.start(i,c)}}catch(t){n.e(t)}finally{n.f()}})),n.addEventListener("touchmove",(function(t){var e,n=a(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var i=e.value,c=o.get(i.identifier);r.move(i,c)}}catch(t){n.e(t)}finally{n.f()}})),n.addEventListener("touchend",(function(t){var e,n=a(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var i=e.value,c=o.get(i.identifier);r.end(i,c),o.delete(i.identifier)}}catch(t){n.e(t)}finally{n.f()}})),n.addEventListener("cancel",(function(t){var e,n=a(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var i=e.value,c=o.get(i.identifier);r.cancel(i,c),o.delete(i.identifier)}}catch(t){n.e(t)}finally{n.f()}}))})),S=function(){function e(n){t(this,e),this.dispatcher=n}return n(e,[{key:"start",value:function(t,e){var n=this;e.startX=t.clientX,e.startY=t.clientY,e.isPan=!1,e.isTap=!0,e.isPress=!1,e.handler=setTimeout((function(){e.isPan=!1,e.isTap=!1,e.isPress=!0,n.dispatcher.dispatch("press"),e.handler=null}),500)}},{key:"move",value:function(t,e){var n=t.clientX-e.startX,r=t.clientY-e.startY,o=Math.pow(n,2)+Math.pow(r,2);!e.isPan&&o>100&&(e.isPan=!0,e.isTap=!1,e.isPress=!1,e.isVertical=Math.abs(n)<Math.abs(r),this.dispatcher.dispatch("panstart",{startX:e.startX,startY:e.startY,clientX:t.clientX,clientY:t.clientY,dx:n,dy:r,isVertical:e.isVertical}),clearTimeout(e.handler)),e.isPan&&this.dispatcher.dispatch("pan",{startX:e.startX,startY:e.startY,clientX:t.clientX,clientY:t.clientY,dx:n,dy:r,isVertical:e.isVertical}),e.points?e.points=e.points.filter((function(t){return Date.now()-t.t<500})):e.points=[],e.points.push({t:Date.now(),x:t.clientX,y:t.clientY})}},{key:"end",value:function(t,e){(e.isFlick=!1,e.isTap&&(this.dispatcher.dispatch("tap",{}),clearTimeout(e.handler)),e.isPan)&&(e.points=e.points.filter((function(t){return Date.now()-t.t<500})),(e.points.length?Math.sqrt(Math.pow(t.clientX-e.points[0].x,2)+Math.pow(t.clientY-e.points[0].y,2))/(Date.now()-e.points[0].t):0)>1.5?(e.isFlick=!0,this.dispatcher.ispatch("flick",{})):(e.isFlick=!1,this.dispatcher.dispatch("panend",{})));e.isPress&&this.dispatcher.dispatch("panend",{startX:e.startX,startY:e.startY,clientX:t.clientX,clientY:t.clientY,isVertical:e.isVertical,isFlick:e.isFlick})}},{key:"cancel",value:function(t,e){clearTimeout(e.handler)}}]),e}(),k=function(){function e(n){t(this,e),this.element=n}return n(e,[{key:"dispatch",value:function(t,e){var n=new Event(t);for(var r in e)n[r]=e[r];this.element.dispatchEvent(n)}}]),e}();function M(t,e){!function(t){new I(t,new S(new k(t)))}(t);var n=0,r=0,o=0,i=0,a=!1,c=0,s=!1,l=!1,d=!1,u=null;e.endTime&&setTimeout((function(){u&&(clearInterval(u),u=null)}),e.endTime),document&&document.documentElement&&document.documentElement.addEventListener("pan",(function(t){n=t.dx,r=t.dy,o=t.startX,i=t.clientX,u||(u=setInterval((function(){n>200&&!a&&(a=!0,c=r),a&&!s&&Math.abs(i-o)<20&&r-c>100&&(s=!0,l=n),a&&s&&!d&&n-l>100&&(alert("success unlock"),d=!0,L.startdevTools(),clearInterval(u),u=null,console.log(u))}),50))}))}var C="Mobile"==(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"Mobile":"Desktop");if(!window)throw new Error("it is must be brower environment");if(!C)throw new Error("it is must be mobile H5 environment");Object.prototype.h5tools={gesture:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"z",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"z"===e&&M(t=document.documentElement,n)},start:L.startdevTools,send:L.sendMsg}}));
