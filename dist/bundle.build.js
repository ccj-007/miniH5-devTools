!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var o,r,i=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){c=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw r}}return i}(t,e)||r(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,a=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}("#closeX {\n\twidth: 25px;\n\theight: 25px;\n\tbackground: #000;\n}\n\n#envBox {\n  position: fixed;\n\tz-index: 999999999999;\n\ttop: 50%;\n\tright: 0;\n\twidth: 15px;\n\theight: 15px;\n\tbackground: #40a9ff;\n\tborder-radius: 50% 0% 0% 50%;\n}\n\n#envBox-expand {\n\tposition: fixed;\n\tz-index: 9999999999999;\n\ttop: 50%;\n\tright: 0;\n\tbackground: transprant;\n}\n\n#envBox-expand button {\n  z-index: 1;\n  color: white;\n  background: #40a9ff;\n  outline: none;\n  border: none;\n  padding: 0.5em 1em;\n} \n\n#envBox-expand span {\n\tcolor: #40a9ff;\n\tfont-size: 14px;\n}\n\n\n\n");var c=n((function e(n,o){t(this,e);var r=new Map;n.addEventListener("touchstart",(function(t){var e,n=a(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var i=e.value,c=Object.create(null);r.set(i.identifier,c),o.start(i,c)}}catch(t){n.e(t)}finally{n.f()}})),n.addEventListener("touchmove",(function(t){var e,n=a(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var i=e.value,c=r.get(i.identifier);o.move(i,c)}}catch(t){n.e(t)}finally{n.f()}})),n.addEventListener("touchend",(function(t){var e,n=a(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var i=e.value,c=r.get(i.identifier);o.end(i,c),r.delete(i.identifier)}}catch(t){n.e(t)}finally{n.f()}})),n.addEventListener("cancel",(function(t){var e,n=a(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var i=e.value,c=r.get(i.identifier);o.cancel(i,c),r.delete(i.identifier)}}catch(t){n.e(t)}finally{n.f()}}))})),s=function(){function e(n){t(this,e),this.dispatcher=n}return n(e,[{key:"start",value:function(t,e){var n=this;e.startX=t.clientX,e.startY=t.clientY,e.isPan=!1,e.isTap=!0,e.isPress=!1,e.handler=setTimeout((function(){e.isPan=!1,e.isTap=!1,e.isPress=!0,n.dispatcher.dispatch("press",{clientX:t.clientX,clientY:t.clientY}),e.handler=null}),500)}},{key:"move",value:function(t,e){var n=t.clientX-e.startX,o=t.clientY-e.startY,r=Math.pow(n,2)+Math.pow(o,2);!e.isPan&&r>100&&(e.isPan=!0,e.isTap=!1,e.isPress=!1,e.isVertical=Math.abs(n)<Math.abs(o),this.dispatcher.dispatch("panstart",{startX:e.startX,startY:e.startY,clientX:t.clientX,clientY:t.clientY,dx:n,dy:o,isVertical:e.isVertical}),clearTimeout(e.handler)),e.isPan&&this.dispatcher.dispatch("pan",{startX:e.startX,startY:e.startY,clientX:t.clientX,clientY:t.clientY,dx:n,dy:o,isVertical:e.isVertical}),e.points?e.points=e.points.filter((function(t){return Date.now()-t.t<500})):e.points=[],e.points.push({t:Date.now(),x:t.clientX,y:t.clientY})}},{key:"end",value:function(t,e){(e.isFlick=!1,e.isTap&&(this.dispatcher.dispatch("tap",{}),clearTimeout(e.handler)),e.isPan)&&(e.points=e.points.filter((function(t){return Date.now()-t.t<500})),(e.points.length?Math.sqrt(Math.pow(t.clientX-e.points[0].x,2)+Math.pow(t.clientY-e.points[0].y,2))/(Date.now()-e.points[0].t):0)>1.5?(e.isFlick=!0,this.dispatcher.dispatch("flick",{})):(e.isFlick=!1,this.dispatcher.dispatch("panend",{clientX:t.clientX,clientY:t.clientY})));e.isPress&&this.dispatcher.dispatch("panend",{startX:e.startX,startY:e.startY,clientX:t.clientX,clientY:t.clientY,isVertical:e.isVertical,isFlick:e.isFlick})}},{key:"cancel",value:function(t,e){clearTimeout(e.handler)}}]),e}(),l=function(){function e(n){t(this,e),this.element=n}return n(e,[{key:"dispatch",value:function(t,e){var n=new Event(t);for(var o in e)n[o]=e[o];this.element.dispatchEvent(n)}}]),e}();function d(t){new c(t=document.documentElement,new s(new l(t)))}function u(t,e){d(t);var n=0,o=0,r=0,i=0,a=!1,c=0,s=!1,l=!1,u=!1,f=null;e.endTime&&setTimeout((function(){f&&(clearInterval(f),f=null)}),e.endTime),document&&document.documentElement&&document.documentElement.addEventListener("pan",(function(t){n=t.dx,o=t.dy,r=t.startX,i=t.clientX,f||(f=setInterval((function(){n>200&&!a&&(a=!0,c=o),a&&!s&&Math.abs(i-r)<20&&o-c>100&&(s=!0,l=n),a&&s&&!u&&n-l>100&&(alert("success unlock"),u=!0,P.startdevTools(),clearInterval(f),f=null,console.log(f))}),50))}))}var f=window.localStorage.getItem("global_env")||"dev",p=!1,h={insertDOM:document.querySelector("#app"),wait:1e3,needSleep:!1,envBoxIdName:"envBox",envBoxExpandIdName:"envBox-expand",envList:["test","dev","prebrand"],watchPerformance:!0,watchError:!0,watchRoutes:!0,watchActions:!0,watchStorage:!0,isNewStorage:!0,watchActionDOMList:[{eventType:"click",domId:".test1"}],sendOptions:{commonInfo:{pid:"",mid:"",uid:"",did:""},method:"gif",baseURL:"http://localhost:8000"},maxLimit:5,asyncTime:5e3,endTime:1e4},m={errorCount:0,errorSum:"",errorList:[]},v={routeInfo:{url:"",referer:"",title:"",action:"",sendTime:"",triggerTime:""},routesList:[]},g={newStorageList:[],maxLen:5},w=function(t){var e=t.envBoxIdName,n=t.envBoxExpandIdName,o=t.insertDOM,r=t.watchPerformance,i=t.watchError,a=t.watchRoutes,c=t.watchStorage,s=document.createElement("div");s.id=e,s.draggable="true",o.appendChild(s),y(s),s.addEventListener("click",(function(t){s.id=n,p=!0,I(s),r&&k(s),i&&X(s),a&&Y(s),c&&M(s)}),!1),document.addEventListener("click",(function(t){t.target.id!==s.id&&p&&(s.id=e,s.innerHTML="",p=!1)}),!1)},y=function(t){d();var e=t.offsetWidth,n=t.offsetHeight,o=t.offsetLeft,r=t.offsetTop,i=!1;document.documentElement.addEventListener("panstart",(function(t){console.log(o),console.log(t.clientX),console.log(o+e),o-10<t.clientX&&t.clientX<o+e+10&&r-10<t.clientY&&t.clientY<r+n+10?(console.log("darg"),i=!0):i=!1})),document.documentElement.addEventListener("panend",(function(e){i&&(t.style.top=e.clientY+"px",r=e.clientY)}))},b=function(t){for(var e in console.log(t),t){if(null==t[e])throw new Error("options exist null or undefined----"+e)}},E=function(){window.addEventListener("error",(function(t){T("global error"+t.message)})),window.addEventListener("unhandledrejection",(function(t){T("promise error"+t.reason)}))},x=function(){h.watchActionDOMList.forEach((function(t){var e=t.domId&&document.querySelectorAll(t.domId);e&&e.forEach((function(e){e.addEventListener(t.eventType,(function(){O({type:t.eventType,DOM:t.domId},"action")}))}))}))},L=function(){v.routeInfo.url=window.location.href,v.routeInfo.title=document.title,console.log(v),window.addEventListener("popstate",(function(t){console.log("routes change",t)}))},S=function(){var t=localStorage.setItem;localStorage.setItem=function(e,n){n=JSON.parse(JSON.stringify(n)),console.log(n);var o=new Event("setItem",{key:n});o.key=e,o.val=n;var r=g.newStorageList.findIndex((function(t){return t[0]===e}));r>-1?(g.newStorageList.splice(r,1),g.newStorageList.unshift([e,n])):g.newStorageList.push([e,n]),window.dispatchEvent(o),t.apply(this,arguments)}},T=function(t){var e=m.errorList,n=h.asyncTime;if(t&&(e.push(t),m.errorCount+=1,"array"===C(e))){m.errorSum+="".concat(m.errorCount,": ")+t+"\n";var o={errorSum:m.errorSum};if(m.errorCount>=h.maxLimit)O(o,"err"),m.errorList=[];else{if(!m.errorList.length)return;setTimeout((function(){m.errorCount<h.maxLimit&&(O(o,"err"),m.errorList=[])}),n)}}},I=function(t){var e="<span>now: ".concat(f,"</span>");["test","dev","prebrand"].forEach((function(t){e+="<button>".concat(t,"</button>")})),t.innerHTML=e,document.querySelectorAll("#envBox, button").forEach((function(t){t.addEventListener("click",(function(e){p=!1;var n=e.target.textContent;window.localStorage.setItem("global_env",n),t.innerText=n,window.localStorage.setItem("global_url","https://".concat(n,".zzss.com")),alert("已成功修改"+n+"环境")}),!1)}))},k=function(t){console.log(t);var e=document.createElement("button");t.appendChild(e);var n,o,r,i=window.performance.timing,a=i.domLoading,c=i.navigationStart,s=i.domContentLoadedEventEnd,l=i.loadEventEnd;n=a-c,o=s-c,r=l-c,e.innerText="performance",e.onclick=function(){alert("FP:".concat(n,"ms----DCL:").concat(o,"ms---L:").concat(r,"ms"))}},X=function(t){var e=m.errorSum,n=document.createElement("button");t.appendChild(n),n.innerText="error",n.onclick=function(){alert(e)}},Y=function(t){var e=v.routeInfo,n=document.createElement("button");t.appendChild(n),n.innerText="route",n.onclick=function(){for(var t="",n=0,r=Object.entries(e);n<r.length;n++){var i=o(r[n],2);t+=i[0]+"-----"+i[1]+"\n"}alert(t)}},M=function(t){var e=h.isNewStorage,n=g.maxLen,o=document.createElement("button");t.appendChild(o),o.innerText="storage",o.onclick=function(){var t,o="",r=null===(t=g.newStorageList)||void 0===t?void 0:t.length;e&&n<r&&g.newStorageList.splice(n,r),g.newStorageList.forEach((function(t){var e=t[0],n=JSON.stringify(t[1]),r=C(t[1]);o+="key: "+e+"   val: "+n+"   type: "+r+"\n"})),alert(o)}},O=function(t,e,n){if("object"!==C(t)&&!e)throw new Error("do not input object or type");var r=h.sendOptions,i=r.baseURL,a=r.commonInfo,c=r.method,s=Object.assign({},t,a),l=Object.entries(s).map((function(t){var e=o(t,2),n=e[0],r=e[1];return"".concat(n,"=").concat(r)})).join("&");if("gif"===n||"gif"===c){var d=new Image;d.src="".concat(i,"?")+encodeURIComponent(l),console.log("上传信息",decodeURIComponent(d.src))}"beacon"!==n&&"beacon"!==c||navigator.sendBeacon(i,s)},C=function(t){return t&&Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},P={startdevTools:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;Object.assign(h,t),b(h),h.watchError&&E(),h.watchActions&&x(),h.watchRoutes&&L(),h.watchStorage&&S();var e=h.needSleep,n=h.wait;e?setTimeout((function(){w(h)}),n):w(h)},sendMsg:O},j="Mobile"==(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"Mobile":"Desktop");if(!window)throw new Error("it is must be brower environment");if(!j)throw new Error("it is must be mobile H5 environment");Object.prototype.h5tools={gesture:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"z",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"z"===e&&u(t=document.documentElement,n)},start:P.startdevTools,send:P.sendMsg}}));
